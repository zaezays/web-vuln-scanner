{% extends "base.html" %} 
{% block content %} 
<div class="container mt-4"> 
  <h2>üîç Scan a Website</h2>

  <!-- Flash messages --> 
   {% with messages = get_flashed_messages(with_categories=true) %} 
   {% if messages %} {% for category, message in messages %} 
   <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
    {{ message }} 
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"> </button> 
  </div> 
  {% endfor %} 
  {% endif %} 
  {% endwith %}

  <!-- Scan form --> 
   <form method="POST" action="{{ url_for('main.scan_page') }}"> 
    {{ form.hidden_tag() }}
      <!-- CSRF protection --> 
      
    <div class="mb-3">
      {{ form.url.label(class="form-label") }}
      {{ form.url(class="form-control", placeholder="http://example.com") }}
    </div>
    <button type="submit" class="btn btn-primary">Start Scan</button> 
  </form>

  <!-- Results --> 
   {% if scan_result %} 
   <hr> <h4>Results for <code>{{ target_url }}</code></h4> 
   {% if scan_result|length == 0 %} 
   <div class="alert alert-success">‚úÖ No vulnerabilities found.</div> 
   {% else %} 
   <ul class="list-group mt-3"> 
    {% for alert in scan_result %} 
    <li class="list-group-item"> 
      <h5 class="text-danger">{{ alert.alert }}</h5> 
      <p><strong>Risk:</strong> {{ alert.risk }}</p> 
      <p><strong>Description:</strong> {{ alert.description }}</p> 
      <p><strong>Solution:</strong> {{ alert.solution }}</p> 
    </li> 
    {% endfor %} 
  </ul> 
  {% endif %} 
  {% endif %} 
</div> 
{% endblock %}